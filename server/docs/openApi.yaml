openapi: 3.0.0
info:
  title: Portifi AI API
  version: 1.0.0
  description: API documentation for AI Portfolio Generator

servers:
  - url: http://localhost:5000/api/v1

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    ApiResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        data:
          type: object

    Resume:
      type: object
      properties:
        id:
          type: string
        status:
          type: string
          enum: [UPLOADED, PARSING, PARSED, FAILED]
        createdAt:
          type: string
          format: date-time

    Portfolio:
      type: object
      properties:
        id:
          type: string
        status:
          type: string
          enum: [DRAFT, PUBLISHED]
        createdAt:
          type: string
          format: date-time

paths:
  # =========================
  # AUTH
  # =========================

  /auth/signup:
    post:
      summary: Register new user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                email:
                  type: string
                password:
                  type: string
      responses:
        "201":
          description: User created

  /auth/login:
    post:
      summary: Login user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                password:
                  type: string
      responses:
        "200":
          description: Login successful

  # =========================
  # RESUME
  # =========================

  /resumes:
    post:
      summary: Upload resume file
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
      responses:
        "201":
          description: Resume uploaded

  /resumes/{resumeId}:
    get:
      summary: Get resume status
      security:
        - bearerAuth: []
      parameters:
        - name: resumeId
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Resume status fetched

  /resumes/{resumeId}/parse:
    post:
      summary: Trigger resume parsing
      security:
        - bearerAuth: []
      parameters:
        - name: resumeId
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Parsing started

  # =========================
  # TEMPLATES
  # =========================

  /templates:
    get:
      summary: Get all templates
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Templates fetched

  /templates/{templateId}:
    get:
      summary: Get single template
      security:
        - bearerAuth: []
      parameters:
        - name: templateId
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Template fetched

  # =========================
  # PORTFOLIO
  # =========================

  /portfolios:
    post:
      summary: Create portfolio from resume
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                resumeId:
                  type: string
                templateId:
                  type: string
      responses:
        "201":
          description: Portfolio created

  /portfolios/{portfolioId}:
    get:
      summary: Get portfolio
      security:
        - bearerAuth: []
      parameters:
        - name: portfolioId
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Portfolio fetched

    put:
      summary: Update portfolio
      security:
        - bearerAuth: []
      parameters:
        - name: portfolioId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                dataSnapshot:
                  type: object
      responses:
        "200":
          description: Portfolio updated

  /portfolios/{portfolioId}/publish:
    post:
      summary: Publish portfolio
      security:
        - bearerAuth: []
      parameters:
        - name: portfolioId
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Portfolio published

  /portfolios/{portfolioId}/unpublish:
    post:
      summary: Unpublish portfolio
      security:
        - bearerAuth: []
      parameters:
        - name: portfolioId
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Portfolio unpublished

  # =========================
  # DASHBOARD
  # =========================

  /dashboard:
    get:
      summary: Get dashboard data
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Dashboard data fetched

  # =========================
  # PUBLIC
  # =========================

  /public/{slug}:
    get:
      summary: Get public portfolio
      parameters:
        - name: slug
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Public portfolio fetched
